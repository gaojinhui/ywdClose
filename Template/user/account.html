<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>我的账户</title>
	<link rel="stylesheet" href="__LAY__/css/layui.css" media="all" />
	<link href="/public/selector/css/WTMap.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="/public/selector/js/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="/public/selector/js/WTMap.js"></script>
	<style>
		body{background:#FFFFFF !important;font:14px/30px 'Microsoft YaHei','微软雅黑';cursor:auto; padding: 10px 2px 0 10px;}
	</style>
</head>
<style>
	td .layui-table-cell{height:40px;line-height:40px;}
	td .layui-table-cell p{height:20px;line-height:20px;}
</style>
<body style="margin-top: 10px;">
<div class="mt10"></div>
<form class="layui-form" action="javascript:">
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">认证类型</label>
			<div class="layui-input-inline" style="line-height: 250%;">
				企业认证
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">认证角色</label>
			<div class="layui-input-inline" style="line-height: 250%; color: red">
				{$result.member_type_text}
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">认证状态</label>
			<div class="layui-input-inline">
				<input type="text" name="auth_status" lay-verify="required" disabled value="{$result.auth_text}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">会员类型</label>
			<div class="layui-input-inline">
				<input type="text" name="member_type" lay-verify="required" autocomplete="off" disabled value="{$result.member_type_text}" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">企业名称</label>
			<div class="layui-input-inline">
				<input type="tel" name="company" lay-verify="required" value="{$result.company}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">企业简称</label>
			<div class="layui-input-inline">
				<input type="text" name="company_short" lay-verify="required" value="{$result.company_short}" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">行业</label>
			<div class="layui-input-inline">
				<select name="trade" lay-filter="aihao">
					<option value=""></option>
					<option value="1" selected="">农业</option>
				</select>
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">所属地区</label>
			<div class="layui-input-inline">
				<input id="txtfrom" autocomplete="off" value="{$result.city}" name="txtfrom" class="w281 fl layui-input" validate="required" txtholder="请选择 省-市-县" type="text" wtmap="{c:'txtfrom',cb:true}" readonly />
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">手机号</label>
			<div class="layui-input-inline">
				<input type="text" name="user_phone" lay-verify="required|phone" value="{$result.phone}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
		<label class="layui-form-label">详细地址</label>
		<div class="layui-input-block">
			<input autocomplete="off" name="address" style="width: 190px" value="{$result.company_address}" class="w281 fl layui-input" validate="required"  type="text" />
		</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">联系人姓名</label>
			<div class="layui-input-inline">
				<input type="text" name="username" lay-verify="required" value="{$result.username}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">办公电话</label>
			<div class="layui-input-inline">
				<input type="text" name="companyphone" lay-verify="required" value="{$result.company_phone}" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">邮编</label>
			<div class="layui-input-inline">
				<input type="text" name="email" lay-verify="email" value="{$result.email}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">传真</label>
			<div class="layui-input-inline">
				<input type="text" name="fax" lay-verify="required" value="{$result.fax}"  autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">

		<div class="layui-inline">
			<label class="layui-form-label">结算银行网点</label>
			<div class="layui-input-inline">
				<input type="text" name="bank_address" lay-verify="required" value="{$result.bank_address}"  autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">结算银行账号</label>
			<div class="layui-input-inline">
				<input type="text" name="bank_number" lay-verify="required" value="{$result.bank_number}"  autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">

		<div class="layui-inline">
			<label class="layui-form-label">法人证件号</label>
			<div class="layui-input-inline">
				<input type="text" name="cardid" lay-verify="required" value="{$result.cardid}" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">法人姓名</label>
			<div class="layui-input-inline">
				<input type="text" name="corporation" lay-verify="required" value="{$result.corporation}" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">

		<div class="layui-inline">
			<label class="layui-form-label">身份证照片</label>
			<div class="layui-input-inline">
				<div class="layui-upload">
					<button type="button" class="layui-btn layui-btn-danger" id="test7"><i class="layui-icon"></i>上传图片</button>
					<div class="layui-upload-list">
						<p ><img id="cardimg" style="width: 190px; height: 190px;" src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1592384863,3732460660&fm=27&gp=0.jpg" class="layui-upload-img"></p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">营业执照号</label>
			<div class="layui-input-inline">
				<input type="text" name="establishment" lay-verify="required" value="{$result.licence}" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">营业执照照片</label>
			<div class="layui-input-inline">
				<div class="layui-upload">
					<button type="button" class="layui-btn layui-btn-danger" id="test8"><i class="layui-icon"></i>上传图片</button>
					<div class="layui-upload-list">
						<p ><img id="licensesimg"  style="width: 190px; height: 190px;" src="{$result.licenceimg}" class="layui-upload-img" id="demo1"></p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="layui-form-item">

		<div class="layui-inline">
			<label class="layui-form-label">企业网站</label>
			<div class="layui-input-inline">
				<input type="text" name="website" lay-verify="required" value="{$result.website}" autocomplete="off" class="layui-input">
			</div>
		</div>

	</div>
	<div class="layui-form-item layui-form-text">
		<label class="layui-form-label">普通文本域</label>
		<div class="layui-input-block">
			<textarea placeholder="请输入内容" name="content"  class="layui-textarea">{$result.company_introudce}</textarea>
		</div>
	</div>


	<div class="layui-form-item">
		<div class="layui-input-block">
			<button class="layui-btn" lay-submit="" lay-filter="demo1">立即提交</button>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label"></label>
			<div class="layui-input-inline">
				1.保证上传信息真实有效
				<BR/>
				1.保证上传信息真实有效
			</div>

			</div>
		</div>
	</div>

</form>


<script src="__LAY__layui.js"></script>
<script>
    layui.use(['form', 'layedit','element', 'laydate','table','laypage','upload'], function(){
        var table = layui.table;
         form = layui.form,
        $= layui.jquery;
    	element = layui.element
    	,laydate = layui.laydate
    	,upload = layui.upload;
        laydate.render({
            elem: '#starttime'
        });
        laydate.render({
            elem: '#endtime'
        });
        laydate.render({
            elem: '#date3'
        });
        upload.render({
            elem: '#test7'
            ,url: '/user/index/upload'
            ,size: 6000 //限制文件大小，单位 KB
            ,field:'image'
            ,done: function(res){
                if(res.error_code==0){
                    layer.msg('上传成功',{time:1000,icon:6},function(){
						$("#cardimg").attr("src",res.data);
                    });

                }else{
                    layer.msg(res.data);
                }
            }
        });
        upload.render({
            elem: '#test8'
            ,url: '/user/index/upload'
            ,size: 6000 //限制文件大小，单位 KB
            ,field:'image'
            ,done: function(res){
                if(res.error_code==0){
                    layer.msg('上传成功',{time:1000,icon:6},function(){
                        $("#licensesimg").attr("src",res.data);
                    });

                }else{
                    layer.msg(res.data);
                }
            }
        });
        function getNaturalWidth(img) {
            var image = new Image()
            image.src = img.src
            var naturalWidth = image.width
            return naturalWidth
        }


        $('#cardimg,#licensesimg').click(function(){
            var height = $(this).naturalHeight;
            var width = $(this).naturalWidth;
            console.log(height);
            layer.open({
                type: 1,
                title: false,
                closeBtn: 1,
                area:'900px',
                skin: 'layui-layer-nobg', //没有背景色
                shadeClose: true,
                content: "<img src="+$(this).attr('src')+">"
            });
        })


        form.on('submit(demo1)', function(data){
            var index=layer.msg('提交中请稍后....', {icon: 16,shade: 0.01,time:false});
           	data.field.licensesimg = $("#licensesimg").attr("src");
            data.field.cardimg = $("#cardimg").attr("src");
			$.post("/user/index/update_userinfo",data.field,function(e){
			    if(e.error_code==0){
			        layer.close(index);
			        layer.msg("操作成功",{time:1000,icon:6},function(){
                        //var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                        //parent.layer.close(index);  // 关闭layer
                        location.reload();
                    });
				}else{
                    layer.close(index);
                    layer.msg(e.msg,{icon:5,time:1000});
				}
			})
            return false;
        });
        //方法级渲染
        table.render({
            elem: '#table_list'
            ,url: '/user/index/mytender_list',
            where: {type: '4', pagesize: 4},
            method: 'post'
            ,cols: [[
                {field:'id', title: 'id',width:50, sort: true}
                ,{field:'starttime_text', title: '发布日期'}
                ,{field:'number', title: '招标编号',width:150}
                ,{field:'title', title: '项目名称',width:150}
                ,{field:'address', title: '项目地址', sort: true, width:150}
                ,{field:'endtime_text', title: '开标时间', width:120}
                ,{field:'status_text', title: '当前状态', width:120}
                ,{field:'status_text', title: '操作', width:120,toolbar:'#barDemo'}
            ]]
            ,id: 'testReload'
            ,page: true,
            done: function(res, curr, count){
                layer.msg("加载完毕....",{time:300});
            },
            text: {
                none: '暂时没有相关数据'
            }
        });



    }).define(function(exports){
        exports('addtender', function(){
            layer.open({
                type: 2,
                title: 'layer mobile页',
                shadeClose: true,
                shade: 0.8,
                area: ['380px', '90%'],
                content: 'mobile/' //iframe的url
            });
        });
    });
</script>
</body>
</html>